# Model Application #

This section describes the procedure for applying the river and system operations previously described. Model input files used to drive 
the model are described in [Section 4](../InputDescription/40.md).

StateMod is structured to perform one of 4 interrelated activities: 

* **Base Flows (Natural Flows)**
* **Simulate**
* **Report**
* **Data Check**

The **Base Flow Module** creates a set of *base streamflows* or *natural flows* which have the impact of historical diversions, return flows, well 
pumping, and reservoir storage, release, evaporation and seepage removed. The generation of a *base streamflow* sequence is necessary for a basin 
planning model in order to analyze a "What If" scenario which includes a proposed water right or operating strategy that may impact historic river 
operations. This module may be executed by the user to develop a *natural streamflow* sequence if all impacts of man are removed or a *base streamflow* 
sequence if only selected impacts of man are removed. When the user selects to generate a *base streamflow* rather than a *natural streamflow* sequence, 
they are implicitly assuming the historic diversion and reservoir operation impacts which are left in the gage will not change significantly under a 
"What If" scenario. By including this component within the model, data preparation requirements are reduced significantly and future simulated return flow 
patterns are, where appropriate, consistent with the base or natural streamflow generation. Note, the base flow module may be executed with missing 
streamflow data (specified by `-999`) to allow manâ€™s impact to be removed prior to filling missing data gaps using a technique such as regression. 

The **Simulate Module** operates the river based on user specified water rights and operating criteria. It begins by reading data that is constant over 
time such as the river network, reservoir structures, diversion structures, instream flow structures, well structures and water rights. Time varying 
data such as streamflow, demands, and climate data are read. Then for every simulation time step, direct, instream, storage, well and operational rights 
are simulated from the most senior to junior priority. At the end of each month, results are printed for each river node to a direct access binary file. 
If a simulation only option is chosen, then the program is complete and detailed reports may be obtained through the Report module. If a simulation plus 
report option is chosen, then at the end of the simulation period, the binary file is read to produce detailed monthly or daily results in a tabular form 
for each diversion, instream flow, well structure, reservoir, and gage as follows: 

*Monthly Model Output*:

* File \*.xdd containing detailed monthly diversion and instream flow results 
* File \*.xre containing detailed monthly reservoir results
* File \*.xwe containing detailed monthly well structure results
* File \*.xir containing detailed monthly instream flow reach results
* File \*.xop containing detailed monthly operational right results
* File \*.xss containing detailed monthly structure results
* File \*.xpl containing detailed monthly plan structure results
* File \*.xca containing call information at the end of a time step
* File \*.xrp containing replacement reservoir data

*Daily Model Output*:

* File *.xdy containing detailed daily diversion and instream flow results 
* File *.xry containing detailed daily reservoir results
* File *.xwy containing detailed daily well structure results

Note the detailed diversion and instream file (\*.xdd) includes information for each river node. Therefore, data associated with the river at every 
structure, stream gage, confluence, etc. is included. The other standard reports include additional information for a particular structure type 
or operational activity. For example, the reservoir summary report includes data for each reservoir account while the instream flow report includes 
data for each node within an instream flow reach.  

The **Report Module** reads the direct access, binary file generated by the simulate module to produce user specified reports and files which may be imported 
to a number of common spreadsheet packages such as Excel for graphing. Following are the standard reports available:

*Monthly Model Reports*:

* Diversion Summary (\*.xdd)
* Reservoir Summary (\*.xre)
* Operational Right Summary (\*.xop) 
* Instream Flow Summary (\*.xir) 
* Well Summary (\*.xwe)
* Plan Summary (\*.xpl)
* Binary Data File (\*.xbn)
* Water Balance (\*.xwb)
* Water Rights List (\*.xwr)
* Graph Data for Diversions and Gages (\*.xdg)
* Graph for Well Structures (\*.xwg)
* Graph Data for Reservoirs (\*.xrg)
* Supply (total diversion), shortage and consumptive use summaries (\*.xsu, \*.xsh, \*.xcu) 

*Daily Mode Reports*:

* Diversion Summary (\*.xdy)
* Reservoir Summary (\*.xry)
* Well Summary (\*.xwy) 

The **Data Check Module** echoes the streamflow and diversion data, prints a comprehensive list of all water rights sorted by priority, tabulates input 
data for simplified reporting, and performs selected data checks of the input files including:

* Stream network is properly connected
* Return flows return to a stream node
* Return flow delay tables total 100% (including loss)
* Distribution of return flows to river nodes or losses equals 100%
* Wells have both a return flow and depletion table
* Water rights are assigned to a structure or operation 
* Structures have a water right
* Demands are assigned to a structure 
* Structures have a demand or operation 
* Reservoir area/capacity tables increase 
* Operational rights are properly specified 
* Time varying data files (streamflow, demands, precipitation, etc.) have data for the selected study period and year type [Calendar Year (January through December), Water Year (October through September), or Irrigation Year (November through October)].  
